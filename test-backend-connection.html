<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Backend Connection Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
        }
        .test-section {
            background: #2a2a2a;
            border: 1px solid #3a3a3a;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        button:hover {
            background: #45a049;
        }
        .result {
            background: #1a1a1a;
            border: 1px solid #3a3a3a;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }
        .success { border-color: #4CAF50; }
        .error { border-color: #f44336; }
        .loading { border-color: #ff9800; }
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
    </style>
</head>
<body>
    <h1>üîå Backend Connection Test</h1>
    <p>Test if the backend server is running and returning real data from the Gemini AI Analyst</p>
    
    <div class="grid">
        <div class="test-section">
            <h2>üìä Analytics Test</h2>
            <button onclick="testAnalytics('Mobile Development')">Test Mobile Development</button>
            <button onclick="testAnalytics('Data Science')">Test Data Science</button>
            <button onclick="testAnalytics('Product Management')">Test Product Management</button>
            <div id="analytics-result" class="result">Click a button to test analytics...</div>
        </div>

        <div class="test-section">
            <h2>üó∫Ô∏è Roadmap Test</h2>
            <button onclick="testRoadmap('Mobile Development')">Test Mobile Roadmap</button>
            <button onclick="testRoadmap('Data Science')">Test Data Roadmap</button>
            <button onclick="testRoadmap('Python')">Test Python Roadmap</button>
            <div id="roadmap-result" class="result">Click a button to test roadmap...</div>
        </div>
    </div>

    <div class="test-section">
        <h2>üéØ Expected Results</h2>
        <div class="result success">
‚úÖ WHAT YOU SHOULD SEE:

Analytics Test:
- Generated by: "Gemini AI" or "Enhanced Fallback System with Real Data"
- Different salary data for each skill:
  ‚Ä¢ Mobile Development: ‚Çπ12,00,000
  ‚Ä¢ Data Science: ‚Çπ15,00,000  
  ‚Ä¢ Product Management: ‚Çπ18,00,000
- Different growth rates and job openings
- Real market data, not generic mock data

Roadmap Test:
- Generated by: "Gemini AI" or "Enhanced Fallback System"
- Skill-specific roadmap titles
- Multiple chapters (4-6 chapters)
- Different content for each skill
        </div>
    </div>

    <script>
        async function testAnalytics(skill) {
            const resultDiv = document.getElementById('analytics-result');
            resultDiv.className = 'result loading';
            resultDiv.textContent = `üîÑ Testing analytics for ${skill}...`;
            
            try {
                const response = await fetch(`http://localhost:5000/api/analytics/market/dynamic?skill=${encodeURIComponent(skill)}&location=India`);
                const data = await response.json();
                
                if (data.success) {
                    resultDiv.className = 'result success';
                    resultDiv.textContent = `‚úÖ SUCCESS for ${skill}:

Generated by: ${data.generatedBy}
Skill: ${data.data.skill}
Location: ${data.data.location}
Average Salary: ${data.data.marketOverview?.averageSalary}
Growth Rate: ${data.data.marketOverview?.growthRate}
Job Openings: ${data.data.marketOverview?.jobOpenings}
Demand Level: ${data.data.marketOverview?.demandLevel}
Competition: ${data.data.marketOverview?.competitionLevel}

Top Companies: ${data.data.topCompanies?.slice(0, 3).map(c => c.name || c).join(', ')}

‚úÖ This is REAL DATA from the Gemini AI Analyst!`;
                } else {
                    resultDiv.className = 'result error';
                    resultDiv.textContent = `‚ùå FAILED for ${skill}:\n${JSON.stringify(data, null, 2)}`;
                }
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.textContent = `‚ùå ERROR for ${skill}:\n${error.message}\n\nMake sure backend server is running on port 5000`;
            }
        }

        async function testRoadmap(skill) {
            const resultDiv = document.getElementById('roadmap-result');
            resultDiv.className = 'result loading';
            resultDiv.textContent = `üîÑ Testing roadmap for ${skill}...`;
            
            try {
                const backendUrl = 'https://skillgenie-backend-3hp[your-full-url].vercel.app';
                const response = await fetch(`${backendUrl}/api/roadmaps/generate/dynamic`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        skill: skill,
                        level: 'intermediate',
                        duration: '3-6 months'
                    })
                });
                const data = await response.json();
                
                if (data.success) {
                    resultDiv.className = 'result success';
                    resultDiv.textContent = `‚úÖ SUCCESS for ${skill}:

Generated by: ${data.generatedBy}
Title: ${data.data.title}
Description: ${data.data.description}
Duration: ${data.data.totalDuration}
Difficulty: ${data.data.difficulty}
Chapters: ${data.data.chapters?.length || 0}

Chapter List:
${data.data.chapters?.map((ch, i) => `${i+1}. ${ch.title} (${ch.duration})`).join('\n') || 'No chapters'}

‚úÖ This is a PERSONALIZED ROADMAP!`;
                } else {
                    resultDiv.className = 'result error';
                    resultDiv.textContent = `‚ùå FAILED for ${skill}:\n${JSON.stringify(data, null, 2)}`;
                }
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.textContent = `‚ùå ERROR for ${skill}:\n${error.message}\n\nMake sure backend server is running on port 5000`;
            }
        }

        // Auto-test on page load
        window.onload = function() {
            setTimeout(() => {
                testAnalytics('Mobile Development');
            }, 1000);
        };
    </script>
</body>
</html>
