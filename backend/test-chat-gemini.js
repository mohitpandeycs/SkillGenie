// Test chat with real Gemini responses
const axios = require('axios');

async function testChatWithGemini() {
  console.log('🧪 Testing Chat with Real Gemini AI...\n');

  try {
    const response = await axios.post('http://localhost:5000/api/chat/message', {
      message: 'What is data science?',
      skill: 'Data Science',
      currentChapter: 1
    }, {
      headers: {
        'Content-Type': 'application/json'
      }
    });

    if (response.data.success) {
      console.log('✅ Chat API Success!');
      console.log('Generated by:', response.data.data.aiResponse.generatedBy);
      console.log('Response length:', response.data.data.aiResponse.content.length);
      console.log('\n📝 AI Response:');
      console.log(response.data.data.aiResponse.content);
      console.log('\n🎯 This should be a detailed, personalized response from Gemini AI');
    } else {
      console.log('❌ Chat API Failed:', response.data);
    }
  } catch (error) {
    console.error('❌ Test Error:', error.response?.data || error.message);
  }
}

// Test different questions
async function testMultipleQuestions() {
  const questions = [
    'What is machine learning?',
    'How do I start learning Python?',
    'What are the career opportunities in AI?'
  ];

  for (const question of questions) {
    console.log(`\n🔍 Testing: "${question}"`);
    try {
      const response = await axios.post('http://localhost:5000/api/chat/message', {
        message: question,
        skill: 'Data Science',
        currentChapter: 2
      });

      if (response.data.success) {
        console.log(`✅ Generated by: ${response.data.data.aiResponse.generatedBy}`);
        console.log(`📝 Response preview: ${response.data.data.aiResponse.content.substring(0, 100)}...`);
      }
    } catch (error) {
      console.log(`❌ Error: ${error.response?.data?.message || error.message}`);
    }
  }
}

async function runTests() {
  await testChatWithGemini();
  await testMultipleQuestions();
}

runTests();
